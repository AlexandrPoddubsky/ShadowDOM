<!DOCTYPE html>
<script src="../../../tools/test/chai/chai.js"></script>
<script src="../../../tools/test/htmltest.js"></script>
<script src="../../shadowdom.js"></script>
<script>

var assert = chai.assert;
var doc = ShadowDOMPolyfill.wrap(document);

var beforeunloadCalled = 0;
window.addEventListener('beforeunload', function(e) {
  assert.equal(e.target, doc);
  beforeunloadCalled++;
});

window.addEventListener('unload', function(e) {
  assert.equal(beforeunloadCalled, 1);
  assert.equal(e.target, doc);
  done();
});

window.addEventListener('load', function(e) {
  window.location.href = 'about:blank';
});

</script>
